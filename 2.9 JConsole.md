
另外一个很有用的工具是JConsole。在现在的JDK中即可找到该工具，兼容JMX。

JConsole可以链接任何Java应用，提供线程使用情况，内存消费，类加载信息，动态编译和操作系统等信息。

输出的信息可以帮我们定位内存泄漏，超负荷的类加载，运行时的线程信息。对于优化堆容量也有帮助。

除了监控外，JConsole还提供了动态修改参数的功能。例如，设置`-verbose:gc`可以改变gc的输出内容。

下面两部分内容描述如何使用JConsole：
- 定位问题
- 监控本地或者远程应用


###### 2.9.1 定位问题
下面是JConsole可以提供查看的数据，每个标题对应一个工具中的TAB。
- 概览
该面板下展示了内存使用情况，线程数量，类数量，CPU占用率等指标。

- 内存
  - 选择内存区域（堆，堆外，其他各种）
    - 随着时间变动的内存使用情况
    - 当前内存大小
    - 提交内存数量
    - 内存大小
  - GC信息，执行了多少次，用了多长时间
  - 堆和非堆使用的百分比

此外在该面板下还能执行GC。

- 线程
  - 线程随着时间的变化情况
  - 活动线程数量
  - 线程峰值
  - 选择一个线程可以看到线程名，状态，调用栈，而且对于阻塞线程可以看到阻塞的具体信息。
  - 死锁检测，底部有个按钮死锁检测，如果存在死锁则可以显示死锁循环。


- 类
  - 显示随着时间变化的加载类的数量
  - 当前加载的类的数量
  - 从启动JVM后加载的类的总数
  - 从启动JVM后卸载的类的总数
  
- VM概要
  - 概要信息
  - 线程概要
  - 内存概要
  - 系统概要
  - JVM信息，参数等等
  
- MBean
该面板以树状展示了应用中注册的MBean，当选中一个节点之后可以看到，属性，操作，通知等其他信息。
  - 你可以执行操作。例如，在`com.sun.management`路径下找到`HotSpotDiagnostic`，在操作中可以看到`dumpHeap`。输入参数（生成文件地址）即可dump一份文件。
  - 可以设置值或者属性。例如，可以通过`com.sun.management.HotspotDiagnostic`下`setVMOption`开修改VM开关等。
  - 你可以监听一个通知，通过`监听`与`取消监听`进行操作
  

###### 2.9.2 监听本地与远程应用
JConsole既可以监控本地服务也可以监控远程服务，监控远程服务通过JMX链接。

监控本地链接，找到应用的PID，双击即可

监控远程服务，输入IP+端口（JMX端口）

JConsole简单示例图：

![image](https://docs.oracle.com/javase/8/docs/technotes/guides/troubleshoot/img/jconsole-memory-tab.gif)








